"0","# Load necessary libraries"
"0","library(caret)"
"0","library(dplyr)"
"0",""
"0","# Load the dataset (assuming train_data and test_data are already available)"
"0","# If not, load the dataset here"
"0","# train_data <- read.csv(""train_data.csv"")"
"0","# test_data <- read.csv(""test_data.csv"")"
"0",""
"0","# Ensure all predictors are numeric"
"0","numeric_predictors <- select_if(data, is.numeric)"
"0",""
"0","data2 <- data"
"0","# Assume 'median_house_value' is the target variable and we want to fit polynomial regression for 'median_income' as an example"
"0",""
"0","# Create polynomial features manually"
"0","data2$median_income_squared <- data2$median_income^2"
"0",""
"0",""
"0","# Fit the polynomial regression model manually"
"0","poly_model <- lm(median_house_value ~ median_income + median_income_squared, data=data2)"
"0",""
"0","# Predict on test data"
"0","poly_predictions <- predict(poly_model, data=data2)"
"0",""
"0","# Define the evaluate_model function to compute evaluation metrics"
"0","evaluate_model <- function(actual, predicted) {"
"0","  mse <- mean((actual - predicted)^2)"
"0","  rmse <- sqrt(mse)"
"0","  mae <- mean(abs(actual - predicted))"
"0","  r2 <- 1 - sum((actual - predicted)^2) / sum((actual - mean(actual))^2)"
"0","  return(list(MSE = mse, RMSE = rmse, MAE = mae, R2 = r2))"
"0","}"
"0",""
"0","# Evaluate the model"
"0","poly_evaluation <- evaluate_model(data2$median_house_value, poly_predictions)"
"0","print(poly_evaluation) #could not we used all variables instead of median_income"
"1","$MSE
"
"1","[1]"
"1"," 6950372537"
"1","
"
"1","
"
"1","$RMSE
"
"1","[1]"
"1"," 83368.89"
"1","
"
"1","
"
"1","$MAE
"
"1","[1]"
"1"," 62520.61"
"1","
"
"1","
"
"1","$R2
"
"1","[1]"
"1"," 0.478024"
"1","
"
"1","
"
